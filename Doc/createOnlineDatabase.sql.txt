CREATE TABLE competition (
  `tavid` INT PRIMARY KEY AUTO_INCREMENT,
  `compName` VARCHAR(50) DEFAULT NULL,
  `compDate` datetime DEFAULT NULL,
  `public` tinyint DEFAULT NULL,
  `organizer` varchar(50) DEFAULT NULL,
  `timediff` int NOT NULL DEFAULT '0',
  `multidaystage` int DEFAULT NULL,
  `multidayparent` int DEFAULT NULL,
  `timezone` varchar(10) DEFAULT NULL,
  `country` varchar(2) DEFAULT NULL,
  videourl varchar(255),
  videotype varchar(255),
  twitter varchar(255),
  `user` varchar(50) NOT NULL,
  `passhash` varchar(64) DEFAULT NULL
);

 CREATE TABLE `results` (
  `tavid` int NOT NULL,
  `dbid` int NOT NULL DEFAULT '0',
  `control` int NOT NULL DEFAULT '0',
  `time` int NOT NULL DEFAULT '0',
  `status` int DEFAULT '0',
  `passingTime` DATETIME NULL DEFAULT NULL,
  `changed` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`tavid`,`dbid`,`control`),
  KEY `Results_Indexd` (`tavid`,`status`,`time`),
  KEY `resIndex2` (`tavid`,`dbid`,`control`,`status`,`time`),
  INDEX tavid (tavid),
  FOREIGN KEY (`tavid`)  REFERENCES competition (tavid)
) DEFAULT CHARSET=utf8mb4;

 CREATE TABLE `runners` (
  `tavid` int NOT NULL,
  `name` varchar(50) NOT NULL DEFAULT '',
  `club` varchar(50) DEFAULT NULL,
  `class` varchar(50) DEFAULT NULL,
  `brick` int DEFAULT NULL,
  `dbid` int NOT NULL DEFAULT '0',
  `bib` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`dbid`,`tavid`),
  KEY `runners_class` (`class`),
  KEY `runnersComp_class` (`tavid`,`class`),
  KEY `runnersComp_club` (`tavid`,`club`),
  FOREIGN KEY (`tavid`)  REFERENCES competition (tavid)
) DEFAULT CHARSET=utf8mb4;

CREATE TABLE `runneraliases` (
  `compid` int NOT NULL,
  `sourceid` varchar(50) NOT NULL,
  `id` int NOT NULL,
  PRIMARY KEY (`compid`,`sourceid`)
) DEFAULT CHARSET=utf8mb4;


CREATE TABLE `splitcontrols` (
  `tavid` int NOT NULL,
  `classname` varchar(50) NOT NULL DEFAULT '',
  `corder` int NOT NULL,
  `code` int NOT NULL,
  `name` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`tavid`,`classname`,`corder`,`code`),
  FOREIGN KEY (`tavid`)  REFERENCES competition (tavid)
) DEFAULT CHARSET=utf8mb4;

 create table classproperties (
 tavid integer NOT NULL,
 className  varchar(50) not null,
 resolution varchar(10),
 havebibnumbers bit default 0,
 startallocation varchar(20),
 primary key (tavid, className),
  FOREIGN KEY (`tavid`)  REFERENCES competition (tavid)
 ) DEFAULT CHARSET=utf8mb4;
